(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.IKun = void 0;
function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }
function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }
/* eslint-disable no-mixed-operators */
var FRAME = 1000 / 60;
var TOUCH_EVENT = 1;
var MOUSE_EVENT = 2;
var EVENT_TYPE = {
  touchstart: TOUCH_EVENT,
  touchmove: TOUCH_EVENT,
  touchend: TOUCH_EVENT,
  mousedown: MOUSE_EVENT,
  mousemove: MOUSE_EVENT,
  mouseup: MOUSE_EVENT,
  mouseleave: MOUSE_EVENT
};
var IKun = /*#__PURE__*/function () {
  function IKun(_ref) {
    var container = _ref.container,
      _ref$muted = _ref.muted,
      muted = _ref$muted === void 0 ? false : _ref$muted;
    _classCallCheck(this, IKun);
    this.muted = muted;
    this.count = 0;
    this.v = {
      r: 12,
      // 角度
      y: 2,
      // 高度
      t: 0,
      // 垂直速度
      w: 0,
      // 横向速度
      d: 0.988 // 衰减
    };

    this.inertia = 0.08; // 惯性
    this.sticky = 0.1; // 粘性
    this.maxR = 60; // 最大角度
    this.maxY = 110; // 最大高度

    this.last = null;
    this.rotate = 0;
    this.initiated = false;
    this.pageX = 0;
    this.pageY = 0;
    this.height = 800;
    this.width = 500;
    this.imageHeight = 300;
    this.imageWidth = 197;
    this.audio = {
      "transient": new Audio("/zhiyin/j.mp3"),
      dancing: new Audio("/zhiyin/jntm.mp3"),
      crazy: new Audio("/zhiyin/ngm.mp3")
    };
    var height = this.height,
      width = this.width;
    this.container = container;
    container.style.position = 'relative';
    container.style.height = height + 'px';
    container.style.width = width + 'px';
    var image = this.image = new Image(197, 300);
    image.src = 'kun.png';
    var outline = this.outline = document.createElement('div');
    outline.style.position = 'absolute';
    outline.style.left = '50%';
    outline.style.top = '50%';
    outline.style.transform = 'translate(-50%, -50%)';
    outline.style.display = 'flex';
    outline.appendChild(image);
    var dpr = window.devicePixelRatio || 1;
    var canvas = this.canvas = document.createElement('canvas');
    canvas.width = width * dpr;
    canvas.height = height * dpr;
    canvas.style.width = width + 'px';
    canvas.style.height = height + 'px';
    var context = this.context = canvas.getContext('2d');
    context.setTransform(1, 0, 0, 1, 0, 0);
    context.scale(dpr, dpr);
    this.mount();
  }
  _createClass(IKun, [{
    key: "setMuted",
    value: function setMuted(muted) {
      Object.values(this.audio).forEach(function (item) {
        item.muted = true;
        item.play();
        item.pause();
        item.muted = muted;
      });
      this.muted = muted;
    }
  }, {
    key: "mount",
    value: function mount() {
      var outline = this.outline,
        container = this.container;
      outline.addEventListener('mousedown', this.start.bind(this)); //鼠标按下 PC
      outline.addEventListener('touchstart', this.start.bind(this)); //触摸开始 Mobile
      document.addEventListener('mousemove', this.move.bind(this)); // 鼠标在屏幕移动 PC
      document.addEventListener('touchmove', this.move.bind(this)); // 手指在屏幕移动 Mobile
      document.addEventListener('mouseup', this.end.bind(this)); // 鼠标松开 PC
      document.addEventListener('mouseleave', this.end.bind(this)); // 鼠标从元素移开 PC
      document.addEventListener('touchcancel', this.end.bind(this)); // 当系统停止跟踪触摸 Mobile
      document.addEventListener('touchend', this.end.bind(this)); // 手指从屏幕移开 Mobile

      container.appendChild(outline);
      container.appendChild(this.canvas);
    }
  }, {
    key: "dispose",
    value: function dispose() {
      var outline = this.outline,
        container = this.container;
      outline.removeEventListener('mousedown', this.start.bind(this));
      outline.removeEventListener('touchstart', this.start.bind(this));
      document.removeEventListener('mousemove', this.move.bind(this));
      document.removeEventListener('touchmove', this.move.bind(this));
      document.removeEventListener('mouseup', this.end.bind(this));
      document.removeEventListener('mouseleave', this.end.bind(this));
      document.removeEventListener('touchcancel', this.end.bind(this));
      document.removeEventListener('touchend', this.end.bind(this));
      container.removeChild(outline);
      container.removeChild(this.canvas);
    }
  }, {
    key: "start",
    value: function start(event) {
      // 保存初始 鼠标的 x,y 坐标
      event.preventDefault();
      var eventType = EVENT_TYPE[event.type];
      if (this.initiated && this.initiated !== eventType) {
        return;
      }
      this.initiated = eventType;
      var touch = 'targetTouches' in event ? event.touches[0] : event;
      this.pageX = touch.pageX;
      this.pageY = touch.pageY;

      // 确保通过用户触发事件获得音频播放授权
      var _this$audio = this.audio,
        _transient = _this$audio["transient"],
        dancing = _this$audio.dancing,
        crazy = _this$audio.crazy;
      _transient.muted = this.muted;
      dancing.muted = this.muted;
      crazy.muted = this.muted;
    }
  }, {
    key: "move",
    value: function move(event) {
      if (EVENT_TYPE[event.type] !== this.initiated) {
        return;
      }
      var touch = 'targetTouches' in event ? event.touches[0] : event;
      var rect = this.container.getBoundingClientRect(); // 获取dom 的 top,lef,right,bottom,width,height
      var leftCenter = rect.left + rect.width / 2; // 获取图片的中心点横坐标的值
      var pageX = touch.pageX,
        pageY = touch.pageY;
      var x = pageX - leftCenter; // 计算横向偏移量
      var y = pageY - this.pageY; // 计算垂直偏移量

      var r = x * this.sticky; // 旋转角度

      r = Math.max(-this.maxR, r);
      r = Math.min(this.maxR, r);
      y = y * this.sticky * 3;
      y = Math.max(-this.maxY, y);
      y = Math.min(this.maxY, y);
      this.v.r = r;
      this.v.y = y;
      this.v.w = 0;
      this.v.t = 0;
      this.draw();
    }
  }, {
    key: "end",
    value: function end(event) {
      if (EVENT_TYPE[event.type] !== this.initiated) {
        return;
      }
      this.initiated = false;
      this.run();
      this.play();
    }
  }, {
    key: "play",
    value: function play() {
      this.count++;
      var _this$audio2 = this.audio,
        _transient2 = _this$audio2["transient"],
        dancing = _this$audio2.dancing,
        crazy = _this$audio2.crazy;
      if (this.count > 2) {
        this.count = 0;
        crazy.currentTime = 0;
        crazy.play();
        _transient2.pause();
        dancing.pause();
      } else if (Math.abs(this.v.r) <= 6) {
        _transient2.currentTime = 0;
        _transient2.play();
        dancing.pause();
        crazy.pause();
      } else if (Math.abs(this.v.r) > 6 && Math.abs(this.v.r) <= 30) {
        dancing.currentTime = 0;
        dancing.play();
        _transient2.pause();
        crazy.pause();
      } else if (Math.abs(this.v.r) > 30) {
        crazy.currentTime = 0;
        crazy.play();
        _transient2.pause();
        dancing.pause();
      }
    }
  }, {
    key: "draw",
    value: function draw() {
      var _this$v = this.v,
        r = _this$v.r,
        y = _this$v.y;
      var x = r * 5;
      this.image.style.transform = "rotate(".concat(r, "deg) translateX(").concat(x, "px) translateY(").concat(y, "px)");
      var context = this.context,
        width = this.width,
        height = this.height;
      context.clearRect(0, 0, width, height);
      context.save();
      context.strokeStyle = '#182562';
      context.lineWidth = 10;
      context.beginPath();
      context.moveTo(this.width / 2, this.height);
      var angle = Math.PI / 180 * r;
      var cos = Math.cos(angle);
      var sin = Math.sin(angle);
      var nx = cos * x - sin * (150 + y) + this.width / 2;
      var ny = sin * x + cos * (150 + y) + this.height / 2 + this.imageHeight / 2 - 150;
      context.quadraticCurveTo(this.width / 2, this.height - 100, nx, ny);
      context.stroke();
      context.restore();
    }
  }, {
    key: "run",
    value: function run() {
      var _this = this;
      if (this.initiated) {
        return;
      }
      var now = Date.now();
      var i = this.inertia;
      var delta = this.last ? now - this.last : 16;
      if (delta < 16) {
        // 如果单帧间隔超过 16ms 那就躺平不处理
        i = i / FRAME * delta;
      }
      this.last = now;
      var _this$v2 = this.v,
        r = _this$v2.r,
        y = _this$v2.y,
        t = _this$v2.t,
        w = _this$v2.w,
        d = _this$v2.d;
      w = w - r * 2 - this.rotate;
      r = r + w * i * 1.2;
      this.v.w = w * d;
      this.v.r = r;
      t = t - y * 2;
      y = y + t * i * 2;
      this.v.t = t * d;
      this.v.y = y;

      // 小于一定动作时停止重绘
      if (Math.max(Math.abs(this.v.w), Math.abs(this.v.r), Math.abs(this.v.t), Math.abs(this.v.y)) < 0.1) {
        return;
      }
      this.draw();
      requestAnimationFrame(function () {
        _this.run();
      });
    }
  }]);
  return IKun;
}();
exports.IKun = IKun;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJ0aGVtZXMvZmx1aWQvc291cmNlL2pzL2N1c3RvbS9pa3VuL2lrdW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7QUNBQTtBQUNBLElBQU0sS0FBSyxHQUFHLElBQUksR0FBRyxFQUFFO0FBRXZCLElBQU0sV0FBVyxHQUFHLENBQUM7QUFDckIsSUFBTSxXQUFXLEdBQUcsQ0FBQztBQUVyQixJQUFNLFVBQVUsR0FBRztFQUNqQixVQUFVLEVBQUUsV0FBVztFQUN2QixTQUFTLEVBQUUsV0FBVztFQUN0QixRQUFRLEVBQUUsV0FBVztFQUVyQixTQUFTLEVBQUUsV0FBVztFQUN0QixTQUFTLEVBQUUsV0FBVztFQUN0QixPQUFPLEVBQUUsV0FBVztFQUNwQixVQUFVLEVBQUU7QUFDZCxDQUFDO0FBQUMsSUFFVyxJQUFJO0VBQ2Ysb0JBQTBDO0lBQUEsSUFBNUIsU0FBUyxRQUFULFNBQVM7TUFBQSxrQkFBRSxLQUFLO01BQUwsS0FBSywyQkFBRyxLQUFLO0lBQUE7SUFDcEMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLO0lBQ2xCLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQztJQUVkLElBQUksQ0FBQyxDQUFDLEdBQUc7TUFDUCxDQUFDLEVBQUUsRUFBRTtNQUFFO01BQ1AsQ0FBQyxFQUFFLENBQUM7TUFBRTtNQUNOLENBQUMsRUFBRSxDQUFDO01BQUU7TUFDTixDQUFDLEVBQUUsQ0FBQztNQUFFO01BQ04sQ0FBQyxFQUFFLEtBQUssQ0FBQztJQUNYLENBQUM7O0lBRUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBQztJQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQzs7SUFFakIs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QUFLLEdBQUcsS0FBSztNQUNwQixDQUFDLENBQUM7TUFDRixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUs7SUFDcEI7RUFBQztJQUFBO0lBQUEsT0FFRCxpQkFBUTtNQUNOLElBQVEsT0FBTyxHQUFnQixJQUFJLENBQTNCLE9BQU87UUFBRSxTQUFTLEdBQUssSUFBSSxDQUFsQixTQUFTO01BRTFCLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQzlELE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQy9ELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQzlELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQzlELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQzNELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQzlELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQy9ELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxD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R0FBRyxJQUFJLENBQUMsTUFBTTtNQUMzQixDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRztNQUNuQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztNQUNoQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO01BRVosQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztNQUNiLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO01BQ2pCLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO01BQ2hCLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7O01BRVo7TUFDQSxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxFQUFFO1FBQ2xHO01BQ0Y7TUFFQSxJQUFJLENBQUMsSUFBSSxFQUFFO01BQ1gscUJBQXFCLENBQUMsWUFBTTtRQUMxQixLQUFJLENBQUMsR0FBRyxFQUFFO01BQ1osQ0FBQyxDQUFDO0lBQ0o7RUFBQztFQUFBO0FBQUE7QUFBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIGVzbGludC1kaXNhYmxlIG5vLW1peGVkLW9wZXJhdG9ycyAqL1xuY29uc3QgRlJBTUUgPSAxMDAwIC8gNjA7XG5cbmNvbnN0IFRPVUNIX0VWRU5UID0gMTtcbmNvbnN0IE1PVVNFX0VWRU5UID0gMjtcblxuY29uc3QgRVZFTlRfVFlQRSA9IHtcbiAgdG91Y2hzdGFydDogVE9VQ0hfRVZFTlQsXG4gIHRvdWNobW92ZTogVE9VQ0hfRVZFTlQsXG4gIHRvdWNoZW5kOiBUT1VDSF9FVkVOVCxcblxuICBtb3VzZWRvd246IE1PVVNFX0VWRU5ULFxuICBtb3VzZW1vdmU6IE1PVVNFX0VWRU5ULFxuICBtb3VzZXVwOiBNT1VTRV9FVkVOVCxcbiAgbW91c2VsZWF2ZTogTU9VU0VfRVZFTlRcbn07XG5cbmV4cG9ydCBjbGFzcyBJS3VuIHtcbiAgY29uc3RydWN0b3IoeyBjb250YWluZXIsIG11dGVkID0gZmFsc2UgfSkge1xuICAgIHRoaXMubXV0ZWQgPSBtdXRlZDtcbiAgICB0aGlzLmNvdW50ID0gMDtcblxuICAgIHRoaXMudiA9IHtcbiAgICAgIHI6IDEyLCAvLyDop5LluqZcbiAgICAgIHk6IDIsIC8vIOmrmOW6plxuICAgICAgdDogMCwgLy8g5Z6C55u06YCf5bqmXG4gICAgICB3OiAwLCAvLyDmqKrlkJHpgJ/luqZcbiAgICAgIGQ6IDAuOTg4IC8vIOihsOWHj1xuICAgIH07XG5cbiAgICB0aGlzLmluZXJ0aWEgPSAwLjA4OyAvLyDmg6/mgKdcbiAgICB0aGlzLnN0aWNreSA9IDAuMTsgLy8g57KY5oCnXG4gICAgdGhpcy5tYXhSID0gNjA7IC8vIOacgOWkp+inkuW6plxuICAgIHRoaXMubWF4WSA9IDExMDsgLy8g5pyA5aSn6auY5bqmXG5cbiAgICB0aGlzLmxhc3QgPSBudWxsO1xuXG4gICAgdGhpcy5yb3RhdGUgPSAwO1xuICAgIHRoaXMuaW5pdGlhdGVkID0gZmFsc2U7XG4gICAgdGhpcy5wYWdlWCA9IDA7XG4gICAgdGhpcy5wYWdlWSA9IDA7XG5cbiAgICB0aGlzLmhlaWdodCA9IDgwMDtcbiAgICB0aGlzLndpZHRoID0gNTAwO1xuXG4gICAgdGhpcy5pbWFnZUhlaWdodCA9IDMwMDtcbiAgICB0aGlzLmltYWdlV2lkdGggPSAxOTc7XG5cbiAgICB0aGlzLmF1ZGlvID0ge1xuICAgICAgdHJhbnNpZW50OiBuZXcgQXVkaW8oYC96aGl5aW4vai5tcDNgKSxcbiAgICAgIGRhbmNpbmc6IG5ldyBBdWRpbyhgL3poaXlpbi9qbnRtLm1wM2ApLFxuICAgICAgY3Jhenk6IG5ldyBBdWRpbyhgL3poaXlpbi9uZ20ubXAzYClcbiAgICB9O1xuICAgIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCB9ID0gdGhpcztcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcblxuICAgIGNvbnN0IGltYWdlID0gKHRoaXMuaW1hZ2UgPSBuZXcgSW1hZ2UoMTk3LCAzMDApKTtcbiAgICBpbWFnZS5zcmMgPSAna3VuLnBuZyc7XG5cbiAgICBjb25zdCBvdXRsaW5lID0gKHRoaXMub3V0bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKTtcbiAgICBvdXRsaW5lLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBvdXRsaW5lLnN0eWxlLmxlZnQgPSAnNTAlJztcbiAgICBvdXRsaW5lLnN0eWxlLnRvcCA9ICc1MCUnO1xuICAgIG91dGxpbmUuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgtNTAlLCAtNTAlKSc7XG4gICAgb3V0bGluZS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgIG91dGxpbmUuYXBwZW5kQ2hpbGQoaW1hZ2UpO1xuXG4gICAgY29uc3QgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgICBjb25zdCBjYW52YXMgPSAodGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKSk7XG4gICAgY2FudmFzLndpZHRoID0gd2lkdGggKiBkcHI7XG4gICAgY2FudmFzLmhlaWdodCA9IGhlaWdodCAqIGRwcjtcbiAgICBjYW52YXMuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG5cbiAgICBjb25zdCBjb250ZXh0ID0gKHRoaXMuY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpKTtcbiAgICBjb250ZXh0LnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTtcbiAgICBjb250ZXh0LnNjYWxlKGRwciwgZHByKTtcblxuICAgIHRoaXMubW91bnQoKTtcbiAgfVxuXG4gIHNldE11dGVkKG11dGVkKSB7XG4gICAgT2JqZWN0LnZhbHVlcyh0aGlzLmF1ZGlvKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLm11dGVkID0gdHJ1ZTtcbiAgICAgIGl0ZW0ucGxheSgpO1xuICAgICAgaXRlbS5wYXVzZSgpO1xuICAgICAgaXRlbS5tdXRlZCA9IG11dGVkO1xuICAgIH0pO1xuICAgIHRoaXMubXV0ZWQgPSBtdXRlZDtcbiAgfVxuXG4gIG1vdW50KCkge1xuICAgIGNvbnN0IHsgb3V0bGluZSwgY29udGFpbmVyIH0gPSB0aGlzO1xuXG4gICAgb3V0bGluZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnN0YXJ0LmJpbmQodGhpcykpOyAvL+m8oOagh+aMieS4iyBQQ1xuICAgIG91dGxpbmUuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuc3RhcnQuYmluZCh0aGlzKSk7IC8v6Kem5pG45byA5aeLIE1vYmlsZVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW92ZS5iaW5kKHRoaXMpKTsgLy8g6byg5qCH5Zyo5bGP5bmV56e75YqoIFBDXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5tb3ZlLmJpbmQodGhpcykpOyAvLyDmiYvmjIflnKjlsY/luZXnp7vliqggTW9iaWxlXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuZW5kLmJpbmQodGhpcykpOyAvLyDpvKDmoIfmnb7lvIAgUENcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5lbmQuYmluZCh0aGlzKSk7IC8vIOm8oOagh+S7juWFg+e0oOenu+W8gCBQQ1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgdGhpcy5lbmQuYmluZCh0aGlzKSk7IC8vIOW9k+ezu+e7n+WBnOatoui3n+i4quinpuaRuCBNb2JpbGVcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuZW5kLmJpbmQodGhpcykpOyAvLyDmiYvmjIfku47lsY/luZXnp7vlvIAgTW9iaWxlXG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQob3V0bGluZSk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcbiAgfVxuXG4gIGRpc3Bvc2UoKSB7XG4gICAgY29uc3QgeyBvdXRsaW5lLCBjb250YWluZXIgfSA9IHRoaXM7XG5cbiAgICBvdXRsaW5lLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuc3RhcnQuYmluZCh0aGlzKSk7XG4gICAgb3V0bGluZS5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5zdGFydC5iaW5kKHRoaXMpKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdmUuYmluZCh0aGlzKSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5tb3ZlLmJpbmQodGhpcykpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmVuZC5iaW5kKHRoaXMpKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5lbmQuYmluZCh0aGlzKSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLmVuZC5iaW5kKHRoaXMpKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuZW5kLmJpbmQodGhpcykpO1xuXG4gICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKG91dGxpbmUpO1xuICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLmNhbnZhcyk7XG4gIH1cblxuICBzdGFydChldmVudCkge1xuICAgIC8vIOS/neWtmOWIneWniyDpvKDmoIfnmoQgeCx5IOWdkOagh1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZXZlbnRUeXBlID0gRVZFTlRfVFlQRVtldmVudC50eXBlXTtcbiAgICBpZiAodGhpcy5pbml0aWF0ZWQgJiYgdGhpcy5pbml0aWF0ZWQgIT09IGV2ZW50VHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmluaXRpYXRlZCA9IGV2ZW50VHlwZTtcblxuICAgIGNvbnN0IHRvdWNoID0gJ3RhcmdldFRvdWNoZXMnIGluIGV2ZW50ID8gZXZlbnQudG91Y2hlc1swXSA6IGV2ZW50O1xuICAgIHRoaXMucGFnZVggPSB0b3VjaC5wYWdlWDtcbiAgICB0aGlzLnBhZ2VZID0gdG91Y2gucGFnZVk7XG5cbiAgICAvLyDnoa7kv53pgJrov4fnlKjmiLfop6blj5Hkuovku7bojrflvpfpn7PpopHmkq3mlL7mjojmnYNcbiAgICBjb25zdCB7IHRyYW5zaWVudCwgZGFuY2luZywgY3JhenkgfSA9IHRoaXMuYXVkaW87XG4gICAgdHJhbnNpZW50Lm11dGVkID0gdGhpcy5tdXRlZDtcbiAgICBkYW5jaW5nLm11dGVkID0gdGhpcy5tdXRlZDtcbiAgICBjcmF6eS5tdXRlZCA9IHRoaXMubXV0ZWQ7XG4gIH1cblxuICBtb3ZlKGV2ZW50KSB7XG4gICAgaWYgKEVWRU5UX1RZUEVbZXZlbnQudHlwZV0gIT09IHRoaXMuaW5pdGlhdGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdG91Y2ggPSAndGFyZ2V0VG91Y2hlcycgaW4gZXZlbnQgPyBldmVudC50b3VjaGVzWzBdIDogZXZlbnQ7XG4gICAgY29uc3QgcmVjdCA9IHRoaXMuY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyAvLyDojrflj5Zkb20g55qEIHRvcCxsZWYscmlnaHQsYm90dG9tLHdpZHRoLGhlaWdodFxuICAgIGNvbnN0IGxlZnRDZW50ZXIgPSByZWN0LmxlZnQgKyByZWN0LndpZHRoIC8gMjsgLy8g6I635Y+W5Zu+54mH55qE5Lit5b+D54K55qiq5Z2Q5qCH55qE5YC8XG4gICAgY29uc3QgeyBwYWdlWCwgcGFnZVkgfSA9IHRvdWNoO1xuXG4gICAgY29uc3QgeCA9IHBhZ2VYIC0gbGVmdENlbnRlcjsgLy8g6K6h566X5qiq5ZCR5YGP56e76YePXG4gICAgbGV0IHkgPSBwYWdlWSAtIHRoaXMucGFnZVk7IC8vIOiuoeeul+WeguebtOWBj+enu+mHj1xuXG4gICAgbGV0IHIgPSB4ICogdGhpcy5zdGlja3k7IC8vIOaXi+i9rOinkuW6plxuXG4gICAgciA9IE1hdGgubWF4KC10aGlzLm1heFIsIHIpO1xuICAgIHIgPSBNYXRoLm1pbih0aGlzLm1heFIsIHIpO1xuXG4gICAgeSA9IHkgKiB0aGlzLnN0aWNreSAqIDM7XG5cbiAgICB5ID0gTWF0aC5tYXgoLXRoaXMubWF4WSwgeSk7XG4gICAgeSA9IE1hdGgubWluKHRoaXMubWF4WSwgeSk7XG5cbiAgICB0aGlzLnYuciA9IHI7XG4gICAgdGhpcy52LnkgPSB5O1xuICAgIHRoaXMudi53ID0gMDtcbiAgICB0aGlzLnYudCA9IDA7XG5cbiAgICB0aGlzLmRyYXcoKTtcbiAgfVxuXG4gIGVuZChldmVudCkge1xuICAgIGlmIChFVkVOVF9UWVBFW2V2ZW50LnR5cGVdICE9PSB0aGlzLmluaXRpYXRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmluaXRpYXRlZCA9IGZhbHNlO1xuICAgIHRoaXMucnVuKCk7XG4gICAgdGhpcy5wbGF5KCk7XG4gIH1cblxuICBwbGF5KCkge1xuICAgIHRoaXMuY291bnQrKztcblxuICAgIGNvbnN0IHsgdHJhbnNpZW50LCBkYW5jaW5nLCBjcmF6eSB9ID0gdGhpcy5hdWRpbztcbiAgICBpZiAodGhpcy5jb3VudCA+IDIpIHtcbiAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgICAgY3JhenkuY3VycmVudFRpbWUgPSAwO1xuICAgICAgY3JhenkucGxheSgpO1xuICAgICAgdHJhbnNpZW50LnBhdXNlKCk7XG4gICAgICBkYW5jaW5nLnBhdXNlKCk7XG4gICAgfSBlbHNlIGlmIChNYXRoLmFicyh0aGlzLnYucikgPD0gNikge1xuICAgICAgdHJhbnNpZW50LmN1cnJlbnRUaW1lID0gMDtcbiAgICAgIHRyYW5zaWVudC5wbGF5KCk7XG4gICAgICBkYW5jaW5nLnBhdXNlKCk7XG4gICAgICBjcmF6eS5wYXVzZSgpO1xuICAgIH0gZWxzZSBpZiAoTWF0aC5hYnModGhpcy52LnIpID4gNiAmJiBNYXRoLmFicyh0aGlzLnYucikgPD0gMzApIHtcbiAgICAgIGRhbmNpbmcuY3VycmVudFRpbWUgPSAwO1xuICAgICAgZGFuY2luZy5wbGF5KCk7XG4gICAgICB0cmFuc2llbnQucGF1c2UoKTtcbiAgICAgIGNyYXp5LnBhdXNlKCk7XG4gICAgfSBlbHNlIGlmIChNYXRoLmFicyh0aGlzLnYucikgPiAzMCkge1xuICAgICAgY3JhenkuY3VycmVudFRpbWUgPSAwO1xuICAgICAgY3JhenkucGxheSgpO1xuICAgICAgdHJhbnNpZW50LnBhdXNlKCk7XG4gICAgICBkYW5jaW5nLnBhdXNlKCk7XG4gICAgfVxuICB9XG5cbiAgZHJhdygpIHtcbiAgICBjb25zdCB7IHIsIHkgfSA9IHRoaXMudjtcbiAgICBjb25zdCB4ID0gciAqIDU7XG4gICAgdGhpcy5pbWFnZS5zdHlsZS50cmFuc2Zvcm0gPSBgcm90YXRlKCR7cn1kZWcpIHRyYW5zbGF0ZVgoJHt4fXB4KSB0cmFuc2xhdGVZKCR7eX1weClgO1xuXG4gICAgY29uc3QgeyBjb250ZXh0LCB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzO1xuXG4gICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgY29udGV4dC5zYXZlKCk7XG5cbiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gJyMxODI1NjInO1xuICAgIGNvbnRleHQubGluZVdpZHRoID0gMTA7XG5cbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIGNvbnRleHQubW92ZVRvKHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCk7XG5cbiAgICBjb25zdCBhbmdsZSA9IChNYXRoLlBJIC8gMTgwKSAqIHI7XG4gICAgY29uc3QgY29zID0gTWF0aC5jb3MoYW5nbGUpO1xuICAgIGNvbnN0IHNpbiA9IE1hdGguc2luKGFuZ2xlKTtcbiAgICBjb25zdCBueCA9IGNvcyAqIHggLSBzaW4gKiAoMTUwICsgeSkgKyB0aGlzLndpZHRoIC8gMjtcbiAgICBjb25zdCBueSA9IHNpbiAqIHggKyBjb3MgKiAoMTUwICsgeSkgKyB0aGlzLmhlaWdodCAvIDIgKyB0aGlzLmltYWdlSGVpZ2h0IC8gMiAtIDE1MDtcblxuICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyh0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLSAxMDAsIG54LCBueSk7XG5cbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICB9XG5cbiAgcnVuKCkge1xuICAgIGlmICh0aGlzLmluaXRpYXRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG5cbiAgICBsZXQgaSA9IHRoaXMuaW5lcnRpYTtcbiAgICBjb25zdCBkZWx0YSA9IHRoaXMubGFzdCA/IG5vdyAtIHRoaXMubGFzdCA6IDE2O1xuICAgIGlmIChkZWx0YSA8IDE2KSB7XG4gICAgICAvLyDlpoLmnpzljZXluKfpl7TpmpTotoXov4cgMTZtcyDpgqPlsLHourrlubPkuI3lpITnkIZcbiAgICAgIGkgPSAoaSAvIEZSQU1FKSAqIGRlbHRhO1xuICAgIH1cbiAgICB0aGlzLmxhc3QgPSBub3c7XG5cbiAgICBsZXQgeyByLCB5LCB0LCB3LCBkIH0gPSB0aGlzLnY7XG5cbiAgICB3ID0gdyAtIHIgKiAyIC0gdGhpcy5yb3RhdGU7XG4gICAgciA9IHIgKyB3ICogaSAqIDEuMjtcbiAgICB0aGlzLnYudyA9IHcgKiBkO1xuICAgIHRoaXMudi5yID0gcjtcblxuICAgIHQgPSB0IC0geSAqIDI7XG4gICAgeSA9IHkgKyB0ICogaSAqIDI7XG4gICAgdGhpcy52LnQgPSB0ICogZDtcbiAgICB0aGlzLnYueSA9IHk7XG5cbiAgICAvLyDlsI/kuo7kuIDlrprliqjkvZzml7blgZzmraLph43nu5hcbiAgICBpZiAoTWF0aC5tYXgoTWF0aC5hYnModGhpcy52LncpLCBNYXRoLmFicyh0aGlzLnYuciksIE1hdGguYWJzKHRoaXMudi50KSwgTWF0aC5hYnModGhpcy52LnkpKSA8IDAuMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZHJhdygpO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLnJ1bigpO1xuICAgIH0pO1xuICB9XG59XG4iXX0=
